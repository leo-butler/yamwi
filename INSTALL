clear

echo "Installing Yamwi ..."
echo ""

echo "  Step 1a. Make temporary folder..."
mkdir -p yamwi/tmp

echo "  Step 1b. Make user folder..."
mkdir yamwi/.maxima

if ! test -r yamwi/site-conf.php; then
    echo "  Step 1c. Set up site-conf.php."
    sed -e '1{}; 2{d}; 3,${s/^\([^\n/]\)/# \1/g;}; ${s/# //}; /file_exists/{d};' yamwi/yamwi-conf.php > yamwi/site-conf.php
else
    echo "  Step 1c. A site-conf.php file has been found. Skipping."
fi

echo "  Step 2. Make www-data as yamwi owner..."
chown -R www-data:www-data yamwi

echo "  Step 3. Give read and executable permissions to owner, and nobody else..."
chmod -R u=rx,go= yamwi

echo -n "  Step 4. Give also write permission in temporary folder..."
chmod u+w yamwi/tmp

echo "and the user folder..."
chmod u+w yamwi/.maxima

echo ""
echo "That's all. Enjoy doing maths on-line!"
